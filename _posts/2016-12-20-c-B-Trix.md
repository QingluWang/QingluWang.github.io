---
layout	:	post
title	:	C语言版俄罗斯方块
---
## 1.思想
&nbsp;&nbsp;表面上看，俄罗斯方块这个游戏是由静态边界和动态下降元素组成，以后的消除也好，变换形状也好，都是对边界内部的方块进行的操作。所以从游戏开发的角度来看，我们需要将这些元素都转化为数字形式以便设计程序，因此，边界及其内容是一个大矩阵，下降元素是一个小矩阵，不同的下降元素也仅仅是矩阵内部数字不同而已。矩阵的话，比较简单的可以用二维数组实现，这种方法也比较直观，比如设计一个int类型的二维数组，0为无方块，1为有方块，这样通过检测0 1就可以显示边界和不同形状的下降元素。<br>
&nbsp;&nbsp;对于坐标的操作，而这个游戏的核心就是对于坐标的操作，C/C++中有<window.h>这个文件，调用里面的函数SetConsoleCursorInfo（）可以随意的确定光标的坐标位置，以便打印下降元素。<br>
&nbsp;&nbsp;对于下降元素动态显示和静态边界显示以及控制下降元素的设计了，这个可以用多线程的方法实现，C/C++调用<pthread.h>这个文件，它的跨平台兼容性比较好，比如副线程显示静态边界和动态显示下降元素，主线程控制下降元素位置、方向变换。<br>
游戏的基本概念就是这些，下面讲讲我设计这个游戏时遇到的一些问题：

## 2.问题

### 1.下降元素触碰边界判断

   俄罗斯方块有个规则就是，未触及底边界之前，下降元素可在左右边界之间自由移动，一旦触及底边界，则无法左右移动，只能固定在底边或者已有的元素上面。所以判断下降元素触碰边界的方法就是试探下一步是否触及边界，比如想往右移动，则先将坐标x+1,由此判定下降元素这个小矩阵是否有和背景这个大矩阵重合的地方，即在相同位置都为1的地方，如果有，那么就是触碰了边界

### 2.下降元素不断积累，如何保存状态

   我之前说过，背景及边界是一个大矩阵，下降元素是小矩阵，所以每个下降元素触碰了底边界或碰到底边界已有元素之后会被固定下来，此时应当将大矩阵的数据更新，即在大矩阵当前坐标位置将下降元素这个小矩阵范围里的元素值更新到大矩阵的相应范围里

### 3.如何消除一行和如何在元素摞到上边界时判定游戏失败

   消除一行：

        判定如果大矩阵某一行均为1（除了上下边界），则该行以前的值向后统一移一行；

  判定游戏失败：

      判定如果大矩阵某一列均为1（除了左右边界），则游戏失败

## 3.上图

大体效果如下
